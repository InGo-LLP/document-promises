<!doctype html>
<meta charset="utf-8">
<title>test document promises</title>
<script>/*polyfill promise*/typeof Promise=='undefined'&&!function(n){function t(e){if(r[e])return r[e].exports;var o=r[e]={exports:{},id:e,loaded:!1};return n[e].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=n,t.c=r,t.p="",t(0)}({0:function(n,t,r){(function(n){var t=r(/*! ./yaku */84);try{n.Promise=t,window.Promise=t}catch(e){}}).call(t,function(){return this}())},84:function(n,t){(function(t){!function(){"use strict";function r(){return en[$][z]||B}function e(n,t){for(var r in t)n.prototype[r]=t[r];return n}function o(n){return n&&"object"==typeof n}function i(n){return"function"==typeof n}function u(n,t){return n instanceof t}function c(n){return u(n,L)}function f(n,t,r){if(!t(n))throw v(r)}function a(){try{return S.apply(F,arguments)}catch(n){return nn.e=n,nn}}function s(n,t){return S=n,F=t,a}function l(n,t){function r(){for(var r=0;r<o;)t(e[r],e[r+1]),e[r++]=R,e[r++]=R;o=0,e.length>n&&(e.length=n)}var e=I(n),o=0;return function(n,t){e[o++]=n,e[o++]=t,2===o&&en.nextTick(r)}}function h(n,t){var r,e,o,c,f=0;if(!n)throw v(N);var a=n[en[$][q]];if(i(a))e=a.call(n);else{if(!i(n.next)){if(u(n,I)){for(r=n.length;f<r;)t(n[f],f++);return f}throw v(N)}e=n}for(;!(o=e.next()).done;)if(c=s(t)(o.value,f++),c===nn)throw i(e[D])&&e[D](),c.e;return f}function v(n){return new TypeError(n)}function _(n){return(n?"":Q)+(new L).stack}function p(n,t){var r="on"+n.toLowerCase(),e=Y[r];H&&H.listeners(n).length?n===Z?H.emit(n,t._v,t):H.emit(n,t):e?e({reason:t._v,promise:t}):en[n](t._v,t)}function d(n){return n&&n._Yaku}function w(n){if(d(n))return new n(tn);var t,r,e;return t=new n(function(n,o){if(t)throw v();r=n,e=o}),f(r,i),f(e,i),t}function m(n,t){return function(r){E&&(n[K]=_(!0)),t===O?C(n,r):g(n,t,r)}}function k(n,t,r,e){return i(r)&&(t._onFulfilled=r),i(e)&&(n[G]&&p(X,n),t._onRejected=e),E&&(t._pre=n),n[n._pCount++]=t,n._s!==U&&on(n,t),t}function y(n){if(n._umark)return!0;n._umark=!0;for(var t,r=0,e=n._pCount;r<e;)if(t=n[r++],t._onRejected||y(t))return!0}function j(n,t){function r(n){return e.push(n.replace(/^\s+|\s+$/g,""))}var e=[];return E&&(t[K]&&r(t[K]),function o(n){n&&J in n&&(o(n._next),r(n[J]+""),o(n._pre))}(t)),(n&&n.stack?n.stack:n)+("\n"+e.join("\n")).replace(rn,"")}function x(n,t){return n(t)}function g(n,t,r){var e=0,o=n._pCount;if(n._s===U)for(n._s=t,n._v=r,t===A&&(E&&c(r)&&(r.longStack=j(r,n)),un(n));e<o;)on(n,n[e++]);return n}function C(n,t){if(t===n&&t)return g(n,A,v(V)),n;if(t!==P&&(i(t)||o(t))){var r=s(T)(t);if(r===nn)return g(n,A,r.e),n;i(r)?(E&&d(t)&&(n._next=t),d(t)?b(n,t,r):en.nextTick(function(){b(n,t,r)})):g(n,O,t)}else g(n,O,t);return n}function T(n){return n.then}function b(n,t,r){var e=s(r,t)(function(r){t&&(t=P,C(n,r))},function(r){t&&(t=P,g(n,A,r))});e===nn&&t&&(g(n,A,e.e),t=P)}var R,S,F,P=null,Y="object"==typeof window?window:t,E=!1,H=Y.process,I=Array,L=Error,A=0,O=1,U=2,$="Symbol",q="iterator",z="species",B=$+"("+z+")",D="return",G="_uh",J="_pt",K="_st",M="Invalid this",N="Invalid argument",Q="\nFrom previous ",V="Chaining cycle detected for promise",W="Uncaught (in promise)",X="rejectionHandled",Z="unhandledRejection",nn={e:P},tn=function(){},rn=/^.+\/node_modules\/yaku\/.+\n?/gm,en=n.exports=function(n){var t,r=this;if(!o(r)||r._s!==R)throw v(M);if(r._s=U,E&&(r[J]=_()),n!==tn){if(!i(n))throw v(N);t=s(n)(m(r,O),m(r,A)),t===nn&&g(r,A,t.e)}};en["default"]=en,e(en,{then:function(n,t){if(void 0===this._s)throw v();return k(this,w(en.speciesConstructor(this,en)),n,t)},"catch":function(n){return this.then(R,n)},_pCount:0,_pre:P,_Yaku:1}),en.resolve=function(n){return d(n)?n:C(w(this),n)},en.reject=function(n){return g(w(this),A,n)},en.race=function(n){var t=this,r=w(t),e=function(n){g(r,O,n)},o=function(n){g(r,A,n)},i=s(h)(n,function(n){t.resolve(n).then(e,o)});return i===nn?t.reject(i.e):r},en.all=function(n){function t(n){g(o,A,n)}var r,e=this,o=w(e),i=[];return r=s(h)(n,function(n,u){e.resolve(n).then(function(n){i[u]=n,--r||g(o,O,i)},t)}),r===nn?e.reject(r.e):(r||g(o,O,[]),o)},en.Symbol=Y[$]||{},s(function(){Object.defineProperty(en,r(),{get:function(){return this}})})(),en.speciesConstructor=function(n,t){var e=n.constructor;return e?e[r()]||t:t},en.unhandledRejection=function(n,t){try{Y.console.error(W,E?t.longStack:j(n,t))}catch(r){}},en.rejectionHandled=tn,en.enableLongStackTrace=function(){E=!0},en.nextTick=H?H.nextTick:function(n){setTimeout(n)},en._Yaku=1;var on=l(999,function(n,t){var r,e;return e=n._s?t._onFulfilled:t._onRejected,e===R?void g(t,n._s,n._v):(r=s(x)(e,n._v),r===nn?void g(t,A,r.e):void C(t,r))}),un=l(9,function(n){y(n)||(n[G]=1,p(Z,n))})}()}).call(t,function(){return this}())}})</script>
<script>/*polyfill event-listener*/!function(){"use strict";function Event$1(e){if(!e)throw Error('TypeError: Failed to construct "CustomEvent": An event name must be provided.');var t=arguments[1]&&arguments[1].bubbles||!1,n=arguments[1]&&arguments[1].cancelable||!1;if("createEvent"in document){var o=document.createEvent("Event");return o.initEvent(e,t,n),o}var r=document.createEventObject();return r.bubbles=t,r.cancelable=n,r.type=e,r}function CustomEvent(e){if(!e)throw Error('TypeError: Failed to construct "CustomEvent": An event name must be provided.');var t=arguments[1]&&arguments[1].bubbles||!1,n=arguments[1]&&arguments[1].cancelable||!1,o=arguments[1]&&arguments[1].detail||null;if(!("createEvent"in document)){var r=document.createEventObject();return r.bubbles=t,r.cancelable=n,r.detail=o,r.type=e,r}try{var c=document.createEvent("CustomEvent");return c.initCustomEvent(e,t,n,o),c}catch(r){var a=document.createEvent("Event");return a.initEvent(e,t,n),a.detail=o,a}}function indexOf(e,t){for(var n=-1,o=e.length;++n<o;)if(n in e&&e[n]===t)return n;return-1}function addEventListener(e,t){var n=this;n._events||(n._events={}),n._events[e]||!function(){var t=n._events[e]=function(e){e.currentTarget=n,e.relatedTarget=e.fromElement||null,e.target=e.target||e.srcElement||n,e.timeStamp=(new Date).getTime(),"clientX"in e&&(e.pageX=e.clientX+document.documentElement.scrollLeft,e.pageY=e.clientY+document.documentElement.scrollTop),e.preventDefault=function(){e.cancelable!==!1&&(e.returnValue=!1)},e.stopPropagation=function(){e.cancelBubble=!0},e.stopImmediatePropagation=function(){e.cancelBubble=!0,e.cancelImmediate=!0};for(var o=t.list.slice(),r=-1,c=void 0;c=!e.cancelImmediate&&o[++r];)indexOf(t.list,c)!==-1&&"function"==typeof c&&c.call(n,e)};t.list=[],n.attachEvent&&n.attachEvent("on"+e,t)}(),n._events[e].list.push(t)}function removeEventListener(e,t){var n=this;if(n._events&&n._events[e]){var o=indexOf(n._events[e].list,t);o!==-1&&(n._events[e].list.splice(o,1),n._events[e].list.length||(n.detachEvent&&n.detachEvent("on"+e,n._events[e]),delete n._events[e]))}}function dispatchEvent(e){if(!arguments.length)throw new Error("Not enough arguments");if(!e||"string"!=typeof e.type)throw new Error("DOM Events Exception 0");var t=this,n=e.type;try{e.bubbles||!function(){e.cancelBubble=!0;var o=function cancelBubbleEvent(){e.cancelBubble=!0,t.detachEvent("on"+n,cancelBubbleEvent)};t.attachEvent("on"+n,o)}(),t.fireEvent("on"+n,e)}catch(r){var o=e.target=t;do o=e.currentTarget=t,o._events&&"function"==typeof o._events[n]&&o._events[n].call(o,e),"function"==typeof o["on"+n]&&o["on"+n](e),o=9===o.nodeType?o.parentWindow:o.parentNode;while(o&&!e.cancelBubble)}return!0}CustomEvent.prototype=window.Event.prototype;var e=function(){var e=function onreadystatechange(){var e=document.createElement("script");e.src="javascript:void(0)",e.onreadystatechange=function(){"loaded"===e.readyState&&(document.documentElement.removeChild(e),document.dispatchEvent(new Event("DOMContentLoaded")))},document.documentElement.appendChild(e),document.detachEvent("onreadystatechange",onreadystatechange)};document.attachEvent("onreadystatechange",e)};"function"!=typeof window.Event&&(Window.prototype.Event=Event$1,window.Event!==Event$1&&(window.Event=Event$1)),"function"!=typeof window.CustomEvent&&(Window.prototype.CustomEvent=CustomEvent),"function"!=typeof window.dispatchEvent&&(e(),Window.prototype.addEventListener=HTMLDocument.prototype.addEventListener=Element.prototype.addEventListener=addEventListener,Window.prototype.removeEventListener=HTMLDocument.prototype.removeEventListener=Element.prototype.removeEventListener=removeEventListener,Window.prototype.dispatchEvent=HTMLDocument.prototype.dispatchEvent=Element.prototype.dispatchEvent=dispatchEvent)}()</script>
<script src="document-promises.js"></script>
<script>
document.interactive.then(function () {
	var target = document.getElementById('interactive');

	target.setAttribute('data-resolved', true);
	target.setAttribute('class', '');
	target.removeAttribute('class');
});

document.contentLoaded.then(function () {
	var target = document.getElementById('content-loaded');

	target.setAttribute('data-resolved', true);
	target.setAttribute('class', '');
	target.removeAttribute('class');
});

document.loaded.then(function () {
	var target = document.getElementById('loaded');

	target.setAttribute('data-resolved', true);
	target.setAttribute('class', '');
	target.removeAttribute('class');
});
</script>
<style>
pre { padding: 1em; }
[data-resolved="true"] { background-color: #6e6; } [data-resolved="true"]:after { content: " has resolved"; }
[data-resolved="false"] { background-color: #f90; } [data-resolved="false"]:after { content: " has not resolved"; }
</style>
<pre id="interactive" data-resolved="false">document.interactive</pre>
<pre id="content-loaded" data-resolved="false">document.contentLoaded</pre>
<pre id="loaded" data-resolved="false">document.loaded</pre>
